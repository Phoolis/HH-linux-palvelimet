# Verkkosivun salaus

Termistöä [Cloufdlaren What is SSL | SSL definition](https://www.cloudflare.com/learning/ssl/what-is-ssl/) -sivulta: 

- SSL = Secure Sockets Layer
  - vanhempi protokolla
- TSL = Transport Layer Security
  - nykyään käytössä
- HTTPS = TSL salattu HTTP

Silti sanotaan usein SSL kun tarkoitetaan TSL, nimi on juurtunut.

Sitten tiivistelmiin.

[Let's Encrypt - How it Works](https://letsencrypt.org/how-it-works/)
- Automatisoi domainin HTTPS-sertifioinnin
- Käyttää ACME-protokollaa maantiekiitäjän nappaa... eikun sertifikaatin luomiseen
- Julkisen avaimen salausta käytetään domainin testaamiseen:
  - Haastaa webbiservun esim. julkaisemaan tietyn koodin domainin alla -> todiste, että sertifikoinnin pyytäjällä on domain hallussaan
  - Useita haasteita eri lähteistä, jotta pyyntöä ei voi kaapata valheellisesti (haasteethan tapahtuvat salaamattoman http-yhteyden kautta, koska https ei ole vielä käytössä)
  - Jos haastet onnistuvat, Let's Encrypt CA (certificate authority) antaa domainin generoidulle julkiselle avaimelle sertifikaatin
  - Sertifikaatti jaetaan vielä julkisesti usealle Certificate Transparency (CT) lokille
- Sertifikaattiketju: pari isoa juuri sertifikaattia autorisoi alempia vasallisertifikaatteja, jotka sertifioivat taas alemmas, ja selain kun luottaa tähän ketjuun, luottaa myös uuden palvelimen sertifikaattiin vaikkei olisi sitä ikinä ennen nähnyt

[Apache.org - SSL/TSL Strong Encryption: How-To](https://httpd.apache.org/docs/2.4/ssl/ssl_howto.html#configexample)
- Minimiconffi:
```
<VirtualHost *:443>
    ServerName www.example.com
    SSLEngine on
    SSLCertificateFile "/path/to/www.example.com.cert"
    SSLCertificateKeyFile "/path/to/www.example.com.key"
</VirtualHost>
```

SSL päälle Name-Based Virtual Hostiin certbotin avulla yksinkertaisuudessaan:

Reikä tulimuuriin:

`sudo ufw allow 443/tcp`

Asenna certbot:

`sudo apt-get install certbot python3-certbot-apache`

Sertifioi valitut domainit:

`sudo certbot --apache --domains example.com,www.example.com`
